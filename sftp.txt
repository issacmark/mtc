import os
import paramiko

def download_folder(sftp, remote_folder, local_folder):
    try:
        # Create local folder if it doesn't exist
        os.makedirs(local_folder, exist_ok=True)

        # List files and directories in the remote folder
        files = sftp.listdir_attr(remote_folder)

        # Download each file or subfolder
        for item in files:
            remote_path = os.path.join(remote_folder, item.filename)
            local_path = os.path.join(local_folder, item.filename)
            if item.st_mode & 0o400:  # Regular file
                sftp.get(remote_path, local_path)
                print(f"Downloaded file: {item.filename}")
            elif item.st_mode & 0o200:  # Subfolder
                download_folder(sftp, remote_path, local_path)
                print(f"Downloaded subfolder: {item.filename}")

        print("Download completed successfully.")
    except Exception as e:
        print(f"Error downloading folder: {e}")

def upload_folder(sftp, local_folder, remote_folder):
    try:
        # List files and directories in the local folder
        items = os.listdir(local_folder)

        # Upload each file or subfolder
        for item in items:
            local_path = os.path.join(local_folder, item)
            remote_path = os.path.join(remote_folder, item)
            if os.path.isfile(local_path):
                sftp.put(local_path, remote_path)
                print(f"Uploaded file: {item}")
            elif os.path.isdir(local_path):
                sftp.mkdir(remote_path)
                upload_folder(sftp, local_path, remote_path)
                print(f"Uploaded subfolder: {item}")

        print("Upload completed successfully.")
    except Exception as e:
        print(f"Error uploading folder: {e}")

def main():
    # SFTP credentials and paths
    sftp_host = "your_sftp_hostname"
    sftp_port = 22
    sftp_username = "your_sftp_username"
    sftp_password = "your_sftp_password"
    remote_folder = "/path/to/remote/folder"
    local_folder = "/path/to/local/folder"

    try:
        # Establish an SFTP connection
        transport = paramiko.Transport((sftp_host, sftp_port))
        transport.connect(username=sftp_username, password=sftp_password)
        sftp = paramiko.SFTPClient.from_transport(transport)

        # Download or upload folder (choose one)
        # download_folder(sftp, remote_folder, local_folder)
        # upload_folder(sftp, local_folder, remote_folder)

        # Close the SFTP connection
        sftp.close()
        transport.close()
    except Exception as e:
        print(f"Error: {e}")

if __name__ == "__main__":
    main()


#!/bin/bash

# Variables
sftp_user="your_sftp_username"
sftp_host="sftp.example.com"
file_path="/remote/path/to/your/file.txt"

# SFTP command to check if the file exists
check_file_command="ls $file_path"

# Connect to SFTP and run the command
if sftp -q "$sftp_user@$sftp_host" <<< "$check_file_command" 2>/dev/null; then
    echo "File exists."
else
    echo "File does not exist."
fi
