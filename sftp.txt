#!/bin/bash

# Credentials and paths (replace with your values)
SFTP_HOST="your_sftp_hostname"
SFTP_USERNAME="your_sftp_username"
SFTP_PASSWORD="your_sftp_password"
LOCAL_FOLDER="/path/to/local/folder"
REMOTE_FOLDER="/path/to/remote/folder"

# Download a folder from SFTP
function download_folder() {
  # Download files recursively using SCP
  for file in $(curl -u "$SFTP_USERNAME:$SFTP_PASSWORD" "scp://$SFTP_HOST$REMOTE_FOLDER" | grep -v '/$'); do
    curl -u "$SFTP_USERNAME:$SFTP_PASSWORD" "scp://$SFTP_HOST$REMOTE_FOLDER/$file" -o "$LOCAL_FOLDER/$file"
  done
}

# Upload a folder to SFTP
function upload_folder() {
  # Upload files recursively using SCP
  for file in "$LOCAL_FOLDER"/*; do
    filename=$(basename "$file")
    curl -u "$SFTP_USERNAME:$SFTP_PASSWORD" -T "$file" "scp://$SFTP_HOST$REMOTE_FOLDER/$filename"
  done
}

# Choose operation
operation="$1"

if [[ $operation == "download" ]]; then
  download_folder
elif [[ $operation == "upload" ]]; then
  upload_folder
else
  echo "Invalid operation. Please specify 'download' or 'upload'."
  exit 1
fi

exit 0
